CREATE DATABASE DEMO;
CREATE SCHEMA DEMO_09102024;

CREATE OR REPLACE STORAGE integration aws_s3_integration
type = external_stage
storage_provider='s3'
enabled=true
storage_aws_role_arn='arn:aws:iam::767398062641:role/role-09-sep'
storage_allowed_locations = ('s3://demo-09-sep/');

show integrations;
desc integration aws_s3_integration;

GRANT usage on integration aws_s3_integration to role accountadmin

create or replace file format demo_format
type = 'CSV'
field_delimiter ='|'
skip_header=1;

create or replace stage aws_s3_integration
storage_integration= aws_s3_integration
file_format =  demo_format
url = 's3://demo-09-sep/';


list @aws_s3_integration
remove @aws_s3_integration/orders.csv;

create or replace temporary table demo_customer_info(
Order Id,
Order Date,	
Ship Mode,	
Segment	,
Country	,
City	,
State	,
Postal Code	,
Region	,
Category,	
Sub Category,	
Product Id	,
cost price	,
List Price	,
Quantity	,
Discount Percent,
);

copy into demo_customer_info 
from @aws_s3_integration/orders.csv
file_format =(demo_format);


